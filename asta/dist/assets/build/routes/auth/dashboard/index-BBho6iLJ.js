import"../../../../modulepreload-polyfill-B5Qt9EMX.js";import{A as m,R as b}from"../../../../config-Cv_0j0S0.js";import"https://cdn.jsdelivr.net/npm/chart.js";import"../../../../routes-BLb1p8ki.js";console.log("dashboard js loaded");async function w(){console.log("Fetching user profile...");try{const e=await fetch(`${m.BASE_URL}/profile`,{method:"GET",credentials:"include"});if(e.ok){const t=await e.json();t.success&&t.data&&t.data.profile?(console.log("User profile fetched:",t.data.profile),E(t.data.profile)):(console.error("Failed to fetch user profile: Invalid data format",t),document.getElementById("dashboard-data").textContent="Failed to load profile.")}else{const t=await e.json();console.error("Failed to fetch user profile:",t.message||"Unknown error"),document.getElementById("dashboard-data").textContent=`Error: ${t.message||"Failed to load profile."}`,(e.status===401||e.status===403)&&(console.log("Session expired or invalid, redirecting to login..."),window.location.href="/auth/login")}}catch(e){console.error("Network error during profile fetch:",e),document.getElementById("dashboard-data").textContent="Network error loading profile."}}function E(e){const t=document.getElementById("dashboard-data");t.innerHTML=`
        <!-- <p><strong>Email:</strong> ${e.email}</p> -->
        <p><strong> Hi </strong> ${e.name||"Not set"}</p>
        `}async function C(){console.log("Attempting logout...");try{const e=await fetch(`${m.BASE_URL}/logout`,{method:"POST",credentials:"include"});if(e.ok)console.log("Logout successful. Redirecting to login page."),window.location.href="login";else{const t=await e.json();console.error("Logout failed:",t.message||"Unknown error"),alert("Logout failed. Please try again.")}}catch(e){console.error("Network error during logout:",e),alert("A network error occurred during logout. Please check your connection.")}}w();window.logout=C;console.log("theme js loaded");const p=document.getElementById("sidebar"),k=document.getElementById("sidebarToggle"),L=document.getElementById("mobileMenuToggle");k.addEventListener("click",function(){p.classList.toggle("collapsed")});L.addEventListener("click",function(){p.classList.toggle("open")});const v=document.getElementById("themeToggle");v.addEventListener("click",function(){document.body.classList.toggle("light"),localStorage.setItem("theme",document.body.classList.contains("light")?"light":"dark")});localStorage.getItem("theme")==="light"&&document.body.classList.add("light");const I=document.querySelectorAll(".nav-item.has-submenu");I.forEach(e=>{e.querySelector(".nav-link").addEventListener("click",function(i){i.preventDefault(),e.classList.toggle("open")})});S();function S(){const e=document.getElementById("lineChart").getContext("2d"),t=new Chart(e,{type:"line",data:{labels:["Jan","Feb","Mar","Apr","May","Jun"],datasets:[{label:"New Users",data:[320,450,380,510,620,750],borderColor:"#ff69b4",backgroundColor:"rgba(255, 105, 180, 0.1)",borderWidth:2,tension:.4,fill:!0},{label:"Active Users",data:[500,600,550,700,800,900],borderColor:"#9370db",backgroundColor:"rgba(147, 112, 219, 0.1)",borderWidth:2,tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:getComputedStyle(document.body).getPropertyValue("--text")}}},scales:{x:{grid:{color:getComputedStyle(document.body).getPropertyValue("--border")},ticks:{color:getComputedStyle(document.body).getPropertyValue("--text-secondary")}},y:{grid:{color:getComputedStyle(document.body).getPropertyValue("--border")},ticks:{color:getComputedStyle(document.body).getPropertyValue("--text-secondary")}}}}}),i=document.getElementById("pieChart").getContext("2d"),d=new Chart(i,{type:"doughnut",data:{labels:["Direct","Organic","Referral","Social"],datasets:[{data:[35,25,20,20],backgroundColor:["#ff69b4","#9370db","#6b46c1","#a78bfa"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"70%",plugins:{legend:{position:"right",labels:{color:getComputedStyle(document.body).getPropertyValue("--text")}}}}});new MutationObserver(function(){t.update(),d.update()}).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const f=document.getElementById("notificationsToggle"),r=document.getElementById("notificationsDropdown"),h=document.getElementById("userDropdownToggle"),s=document.getElementById("userDropdownMenu"),l=document.createElement("div");l.className="dropdown-overlay";document.body.appendChild(l);function n(e,t){t?(e.classList.add("show"),l.style.display="block"):(e.classList.remove("show"),l.style.display="none")}f.addEventListener("click",function(e){e.stopPropagation();const t=r.classList.contains("show");n(s,!1),n(r,!t)});h.addEventListener("click",function(e){e.stopPropagation();const t=s.classList.contains("show");n(r,!1),n(s,!t)});l.addEventListener("click",function(){n(r,!1),n(s,!1)});document.addEventListener("click",function(e){!f.contains(e.target)&&!r.contains(e.target)&&n(r,!1),!h.contains(e.target)&&!s.contains(e.target)&&n(s,!1)});async function B(){console.log("Layout script started");function e(){const t={head:'<head><link rel="stylesheet" href="/dashboard/css/dashboard.css" /><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" /></head>'};t&&function(d){const a=document.head,c=document.createElement("template");c.innerHTML=d;const u=[];for(a.querySelectorAll("script, link[rel='modulepreload']").forEach(o=>{(o.tagName==="SCRIPT"&&o.type==="module"||o.tagName==="LINK"&&o.rel==="modulepreload"||o.src?.includes("/assets/router-")||o.href?.includes("/assets/modulepreload-polyfill"))&&u.push(o.outerHTML)});a.firstChild;)a.removeChild(a.firstChild);const y=c.content.cloneNode(!0);a.appendChild(y),u.forEach(o=>{const g=document.createElement("template");g.innerHTML=o,a.appendChild(g.content.firstChild)}),console.log("Updated head with layout content while preserving Vite scripts.")}(t.head)}e()}async function T(){console.log(b)}async function P(){try{await new Promise(e=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e()}),console.log("DOM is ready"),await B(),await T()}catch(e){console.error("Error in main function:",e)}}P();
