import"../../../../modulepreload-polyfill-B5Qt9EMX.js";import{A as P,R as S}from"../../../../config-Cv_0j0S0.js";import"../../../../routes-BLb1p8ki.js";console.log("✅ Reset Password script initialized");const h={RESET_PASSWORD_API:`${P.BASE_URL}/reset-password`,LOGIN_PAGE:"login"},u=document.getElementById("reset-password-form"),c=document.getElementById("new-password"),w=document.getElementById("confirm-password"),l=document.getElementById("auth-status"),g=u.querySelector('button[type="submit"]');let d=null;function n(e,t=!1){console.log(`UI Status: ${e}`),l.textContent=e,l.className=t?"error":"success",l.classList.remove("hidden")}function r(e){g.disabled=e,g.textContent=e?"Resetting...":"Reset Password",u.classList.toggle("loading",e)}function E(){const t=new URLSearchParams(window.location.search).get("token");t?(d=t,console.log("✅ Token extracted from URL.")):(n("Password reset link is invalid or expired. Please request a new one.",!0),console.error("❌ Token not found in URL."),r(!0))}u.addEventListener("submit",async e=>{if(e.preventDefault(),console.log("📝 Reset Password form submission started"),r(!0),l.classList.add("hidden"),!d){n("Missing reset token. Please use the link from your email.",!0),r(!1);return}const t=c.value,i=w.value;if(!t||!i){n("Please fill in both password fields.",!0),r(!1);return}if(t!==i){n("Passwords do not match.",!0),r(!1);return}if(t.length<8){n("Password must be at least 8 characters long.",!0),r(!1);return}n("Attempting to reset password..."),console.log("🔐 Sending password reset request...");try{const a=await fetch(h.RESET_PASSWORD_API,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:d,newPassword:t})}),s=await a.json();console.log("Backend response:",s),a.ok?(n(s.message||"Your password has been successfully reset. Redirecting to login..."),c.value="",w.value="",setTimeout(()=>{window.location.replace(h.LOGIN_PAGE)},2e3)):n(s.message||"Failed to reset password. Please try again.",!0)}catch(a){console.error("❌ Password reset request error:",a),n("An unexpected error occurred. Please try again later.",!0)}finally{r(!1)}});E();c.focus();console.log("📄 Reset Password form ready");async function R(){console.log("Layout script started");function e(){const t={head:'<head><link rel="stylesheet" href="/auth/css/auth.css" /></head>'};t&&function(a){const s=document.head,m=document.createElement("template");m.innerHTML=a;const f=[];for(s.querySelectorAll("script, link[rel='modulepreload']").forEach(o=>{(o.tagName==="SCRIPT"&&o.type==="module"||o.tagName==="LINK"&&o.rel==="modulepreload"||o.src?.includes("/assets/router-")||o.href?.includes("/assets/modulepreload-polyfill"))&&f.push(o.outerHTML)});s.firstChild;)s.removeChild(s.firstChild);const y=m.content.cloneNode(!0);s.appendChild(y),f.forEach(o=>{const p=document.createElement("template");p.innerHTML=o,s.appendChild(p.content.firstChild)}),console.log("Updated head with layout content while preserving Vite scripts.")}(t.head)}e()}async function L(){console.log(S)}async function k(){try{await new Promise(e=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e()}),console.log("DOM is ready"),await R(),await L()}catch(e){console.error("Error in main function:",e)}}k();
